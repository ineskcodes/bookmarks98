(()=>{function e(e,t,s,i){Object.defineProperty(e,t,{get:s,set:i,enumerable:!0,configurable:!0})}var t=globalThis,s={},i={},a=t.parcelRequireb18d;null==a&&((a=function(e){if(e in s)return s[e].exports;if(e in i){var t=i[e];delete i[e];var a={id:e,exports:{}};return s[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){i[e]=t},t.parcelRequireb18d=a);var r=a.register;r("kI8SP",function(t,s){e(t.exports,"register",()=>i,e=>i=e),e(t.exports,"resolve",()=>a,e=>a=e);var i,a,r=new Map;i=function(e,t){for(var s=0;s<t.length-1;s+=2)r.set(t[s],{baseUrl:e,path:t[s+1]})},a=function(e){var t=r.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),r("hIarR",function(t,s){e(t.exports,"getBundleURL",()=>i,e=>i=e);var i,a={};i=function(e){var t=a[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),a[e]=t),t}}),r("dTwV1",function(e,t){e.exports=a("dNLwc")(a("kI8SP").resolve("eM6PU")).then(()=>a("6vhjD"))}),r("dNLwc",function(e,t){var s=a("7lV8K");e.exports=s(function(e){return new Promise(function(t,s){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var i=document.createElement("link");i.href=e,i.rel="preload",i.as="script",document.head.appendChild(i);var a=document.createElement("script");a.async=!0,a.type="text/javascript",a.src=e,a.onerror=function(t){var i=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));a.onerror=a.onload=null,a.remove(),s(i)},a.onload=function(){a.onerror=a.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(a)})})}),r("7lV8K",function(e,t){var s={},i={},a={};e.exports=function(e,t){return function(r){var l=function(e){switch(e){case"preload":return i;case"prefetch":return a;default:return s}}(t);return l[r]?l[r]:l[r]=e.apply(null,arguments).catch(function(e){throw delete l[r],e})}}}),a("kI8SP").register(a("hIarR").getBundleURL("cybPK"),JSON.parse('["cybPK","main.js","eM6PU","../dragAndDrop.createDraggables.ca670dbb.js"]')),document.querySelector(".menu")&&new class{constructor(){this.toggle=document.querySelector(".menu__toggle"),this.details=this.toggle.closest("details"),this.toggle.addEventListener("click",()=>this.toggleMenu()),this.init()}init(){this.toggle.tabIndex=0,this.toggle.setAttribute("role","button"),this.toggle.setAttribute("aria-expanded","false"),this.toggle.setAttribute("aria-controls","menu-content"),this.details.setAttribute("role","presentation")}toggleMenu(){let e=Array.from(document.querySelectorAll(".window"));this.ariaExpanded="false"|JSON.parse(this.toggle.getAttribute("aria-expanded")),this.toggle.setAttribute("aria-expanded",!this.ariaExpanded),e&&e.forEach(e=>e.style.zIndex=0)}},document.querySelector(".bookmarks")&&new class{constructor(){this.list=document.querySelector(".bookmarks"),this.items=Array.from(this.list.querySelectorAll(".bookmark")),this.init()}init(){this.items.forEach(e=>{e.addEventListener("click",this.handleClick),e.setAttribute("data-clickable","")})}handleClick(e){e.currentTarget.querySelector("a[href]").click()}};let l=document.querySelector(".root"),n=l.querySelector("main"),o=l.querySelector("header"),h=l.querySelector("footer"),p=["Black Thatch","Blue Rivets","Bubbles","Carved Stone","Circles","Clouds","Forest","Gold Weave","Houndstooth","Metal Links","Pinstripe","Red Blocks","Sandstone","Setup","Stitches","Straw Mat","Tiles","Triangles","Waves"];new class{constructor(){this.setupElements(),this.loadWallpapers(),this.loadTheme(),this.init()}setupElements(){this.container=this.query(".settings"),this.popup=this.query(".popup",this.container),this.alert={container:this.query(".alert",this.container),firstFocusable:this.query("#alert-close-btn",this.container),closeButtons:this.query(".alert button",this.container,!0),heading:this.query(".alert__heading",this.container),message:this.query(".alert__message",this.container),outer:this.query("#alert-outer",this.container)},this.form=this.query("form",this.container),this.switcher=this.query(".switcher__wallpapers:not([data-placeholder])",this.form),this.buttons={open:this.query("#settings-open-btn",this.container),apply:this.query("#settings-apply-btn",this.container),cancel:this.query("#settings-cancel-btn",this.container),close:this.query("#settings-close-btn",this.container)},this.previewBox=this.query("#wallpaper-preview",this.popup),this.displaySelect=this.query("#display-select",this.form),this.themeSelect=this.query("#theme-select",this.form),this.browseInput=this.query("#browse-input",this.popup),this.dialogs=[this.popup,this.alert.container],this.wallpaperLabels=this.switcher.children}query(e,t=document,s=!1){return s?t.querySelectorAll(e):t.querySelector(e)}loadWallpapers(){localStorage.getItem("wallpapers")?this.wallpapers=JSON.parse(localStorage.getItem("wallpapers")):this.wallpapers=p.map(e=>({name:this.formatName(e),src:this.generateUrl(e),isEnabled:!1,isCustom:!1})),this.selectedWallpaper=this.wallpapers.find(e=>e.isEnabled)}loadTheme(){this.theme=document.documentElement.dataset.theme||"default",this.tempTheme=this.theme}formatName(e){return e.replaceAll(" ","-").replace(/.(png|jpeg|jpg)$/,"").toLowerCase()}generateUrl(e){return`/bookmarks98/${this.formatName(e)}.png`}init(){this.buttons.open.setAttribute("aria-expanded","false"),this.dialogs.forEach(e=>this.trapFocusInside(e)),this.bindEvents()}bindEvents(){this.buttons.open.addEventListener("click",()=>this.togglePopup(!0)),[this.buttons.close,this.buttons.cancel].forEach(e=>e.addEventListener("click",this.cancelSettings.bind(this))),this.handleWallpaperInput.bind(this),this.form.addEventListener("submit",this.handleSubmit.bind(this)),this.buttons.apply.addEventListener("click",this.applySettings.bind(this)),this.displaySelect.addEventListener("input",this.updateDisplayMode.bind(this)),this.browseInput.addEventListener("input",this.handleUpload.bind(this)),this.themeSelect.addEventListener("input",this.previewTheme.bind(this)),this.alert.closeButtons.forEach(e=>{e.addEventListener("click",this.hideAlert.bind(this))}),this.alert.outer.addEventListener("click",this.handleClickOutsideAlert.bind(this))}togglePopup(e){let t=[n,o,h,this.buttons.open],s=e?this.popup:this.buttons.open;this.buttons.open.setAttribute("aria-expanded",`${e}`),this.popup.hidden=!e,t.forEach(t=>this.toggleInertState(e,t)),s.focus(),this.loadWallpaperInputs(e)}trapFocusInside(e){let t=e.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])'),s=t[0],i=t[t.length-1];this.addFocusTrapListeners(s,i)}addFocusTrapListeners(e,t){let s=s=>{"Tab"!==s.key||(s.shiftKey&&s.target===e?(s.preventDefault(),t.focus()):s.shiftKey||s.target!==t||(s.preventDefault(),e.focus()))};[e,t].forEach(e=>e.addEventListener("keydown",s))}cancelSettings(){this.setTheme(!0),this.togglePopup(!1)}toggleInertState(e,t){let s=t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])');t.setAttribute("aria-hidden",`${e}`),s.forEach(t=>t.tabIndex=Number(e)),t.inert=e}loadWallpaperInputs(e){this.wallpaperInputs=[...this.wallpaperLabels].map(e=>e.firstElementChild),e?this.wallpaperInputs.forEach(e=>e.addEventListener("input",e=>this.handleWallpaperInput(e))):this.wallpaperInputs.forEach(e=>e.removeEventListener("input",e=>this.handleWallpaperInput(e)))}handleWallpaperInput(e){let{target:t}=e;"radio"===t.type&&(this.updatePreview(t.value),this.displaySelect.dispatchEvent(new Event("input")))}updatePreview(e){this.setWallpaper(this.previewBox,e)}setWallpaper(e,t){if(this.selectedWallpaper=this.wallpapers.find(e=>e.name===t),this.selectedWallpaper){let{src:t}=this.selectedWallpaper;e.style.setProperty("--wallpaper",`url("${t}")`)}else e.style.setProperty("--wallpaper","none")}handleSubmit(e){e.preventDefault(),this.applySettings(),this.togglePopup(!1)}saveSettings(){this.setLocalStorageItem("wallpapers",this.wallpapers),this.setLocalStorageItem("display-mode",this.displayMode),this.setLocalStorageItem("preview-ratio",this.previewRatio),this.setLocalStorageItem("switcher",this.switcher.innerHTML),this.setLocalStorageItem("theme",this.theme)}setLocalStorageItem(e,t){if(t){t="object"==typeof t?JSON.stringify(t):t;try{localStorage.setItem(e,t)}catch(e){if("QuotaExceededError"===e.name)console.error("Local storage is full. Please free up some space.");else throw e}}}applySettings(){let e=[...this.wallpaperInputs].find(e=>e.checked),t=e.value;this.displayMode=this.displaySelect.value,this.setWallpaper(l,t),this.setDisplayStyle(l,this.displayMode),this.setActiveWallpaper(t),this.resetAppliedClass(e),this.setTheme(!1),this.saveSettings()}resetAppliedClass(e=null){[...this.wallpaperInputs].forEach(e=>e.classList.remove("applied")),e&&e.classList.add("applied")}updateDisplayMode(e){this.displayMode=e.currentTarget.value,this.setDisplayStyle(this.previewBox,this.displayMode)}async setDisplayStyle(e,t){Object.entries({center:{size:"auto",repeat:"no-repeat",position:"center"},tile:{size:"auto",repeat:"repeat",position:"auto"},stretch:{size:"100% 100%",repeat:"no-repeat",position:"auto"}}[t]).forEach(([t,s])=>e.style.setProperty(`--${t}`,s)),this.previewRatio="stretch"!==t?await this.getPreviewRatio():"100% 100%",e.style.setProperty("--preview-size",this.previewRatio)}loadImage(e){return new Promise((t,s)=>{let i=document.createElement("img");i.onload=()=>t(i),i.onerror=s,i.src=e})}calculatePreviewRatio(e,t,s){let{naturalHeight:i,naturalWidth:a}=e;return e.remove(),`${Math.round(100*a/t)}% ${Math.round(100*i/s)}%`}async getPreviewRatio(){let e=l.offsetWidth,t=l.offsetHeight;if(this.selectedWallpaper)try{let s=await this.loadImage(this.selectedWallpaper.src);return this.calculatePreviewRatio(s,e,t)}catch(e){console.error("Failed to load image:",e)}return"100% 100%"}async handleUpload(e){let t=e.target.files[0],s=this.formatName(t.name),i=t.size;if(this.validateFile(i,s))try{let e=await this.readFile(t);this.addCustomWallpaper(t,e)}catch(e){console.error("Error reading file:",e)}}addCustomWallpaper(e,t){let s={name:this.formatName(e.name),src:t,isEnabled:!1,isCustom:!0};this.wallpapers.push(s),this.setLocalStorageItem("wallpapers",this.wallpapers),this.updateSwitcher(s)}readFile(e){return new Promise((t,s)=>{let i=new FileReader;i.onload=e=>{t(e.target.result)},i.onerror=s,i.readAsDataURL(e)})}setActiveWallpaper(e){this.selectedWallpaper=this.wallpapers.find(t=>t.name===e),this.wallpapers.forEach(e=>{e.isEnabled=e===this.selectedWallpaper})}validateFile(e,t){let s=this.wallpapers.find(e=>e.name===t);return e>1048576?(this.showAlert("File Size Exceeds Limit","The file size exceeds the limit of 1MB. Please upload a smaller file."),!1):!s||(this.showAlert("Duplicate File Name",`A file named "${t}" has already been uploaded. Please upload a different file.`),!1)}showAlert(e,t){let s=[n,o,h,this.buttons.open,this.popup];this.alert.heading.innerText=e,this.alert.message.innerText=t,s.forEach(e=>this.toggleInertState(!0,e)),this.alert.outer.hidden=!1,this.alert.container.focus()}hideAlert(){let e=[n,o,h,this.buttons.open,this.popup];this.alert.outer.hidden=!0,e.forEach(e=>this.toggleInertState(!1,e)),this.browseInput.focus()}handleClickOutsideAlert(e){e.target===this.alert.outer&&this.hideAlert()}updateSwitcher(e){let t=document.createElement("label");t.classList.add("wallpaper"),t.setAttribute("for",this.formatName(e.name));let s=document.createElement("input");s.type="radio",s.name="wallpaper",s.value=this.formatName(e.name),s.id=this.formatName(e.name),s.checked=!0;let i=document.createElement("img");i.src=this.switcher.querySelector("img").src;let a=document.createElement("span");a.innerText=e.name,t.append(s,i,a),this.switcher.appendChild(t),s.focus(),this.loadWallpaperInputs(!0),s.dispatchEvent(new Event("input")),this.setLocalStorageItem("switcher",this.switcher.innerHTML)}previewTheme(e){this.tempTheme=e.currentTarget.value;let t=`/bookmarks98/${this.tempTheme}.png`;l.style.setProperty("--theme-preview",`url("${t}")`)}setTheme(e){let t=e?this.theme:this.tempTheme,s=`/bookmarks98/${t}.png`;l.style.setProperty("--theme-preview",`url("${s}")`),this.theme=t,this.tempTheme=this.theme,this.themeSelect.value=this.theme,document.documentElement.dataset.theme=this.theme}},a("dTwV1").then(e=>{e.default()})})();
//# sourceMappingURL=main.js.map
