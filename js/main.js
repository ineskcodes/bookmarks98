(()=>{function e(e,t,s,a){Object.defineProperty(e,t,{get:s,set:a,enumerable:!0,configurable:!0})}var t=globalThis,s={},a={},r=t.parcelRequireb18d;null==r&&((r=function(e){if(e in s)return s[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return s[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},t.parcelRequireb18d=r);var i=r.register;i("kI8SP",function(t,s){e(t.exports,"register",()=>a,e=>a=e),e(t.exports,"resolve",()=>r,e=>r=e);var a,r,i=new Map;a=function(e,t){for(var s=0;s<t.length-1;s+=2)i.set(t[s],{baseUrl:e,path:t[s+1]})},r=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),i("hIarR",function(t,s){e(t.exports,"getBundleURL",()=>a,e=>a=e);var a,r={};a=function(e){var t=r[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),r[e]=t),t}}),i("8GgXA",function(t,s){e(t.exports,"getDraggableType",()=>a),e(t.exports,"getDraggableItemName",()=>r),e(t.exports,"checkIfOverlap",()=>i),e(t.exports,"populateStorage",()=>l),e(t.exports,"getLastPositionFromLocalStorage",()=>n),e(t.exports,"getMaxZIndex",()=>o);let a=e=>e.target.dataset.draggable,r=e=>e.target.dataset.item,i=(e,t)=>"icon"!==a(e)?null:t.some(t=>e.hitTest(t,"25%")),l=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},n=e=>JSON.parse(localStorage.getItem(`${e.target.dataset.item}-position`)),o=([e,t])=>{let s=[getComputedStyle(e).zIndex,getComputedStyle(t).zIndex];return(s=s.map(e=>"auto"===e?0:parseInt(e))).reduce((e,t)=>Math.max(e,t))}}),i("dTwV1",function(e,t){e.exports=r("dNLwc")(r("kI8SP").resolve("eM6PU")).then(()=>r("6vhjD"))}),i("dNLwc",function(e,t){var s=r("7lV8K");e.exports=s(function(e){return new Promise(function(t,s){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var a=document.createElement("link");a.href=e,a.rel="preload",a.as="script",document.head.appendChild(a);var r=document.createElement("script");r.async=!0,r.type="text/javascript",r.src=e,r.onerror=function(t){var a=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));r.onerror=r.onload=null,r.remove(),s(a)},r.onload=function(){r.onerror=r.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(r)})})}),i("7lV8K",function(e,t){var s={},a={},r={};e.exports=function(e,t){return function(i){var l=function(e){switch(e){case"preload":return a;case"prefetch":return r;default:return s}}(t);return l[i]?l[i]:l[i]=e.apply(null,arguments).catch(function(e){throw delete l[i],e})}}}),r("kI8SP").register(r("hIarR").getBundleURL("cybPK"),JSON.parse('["cybPK","main.js","eM6PU","../dragAndDrop.createDraggables.54b4f191.js"]'));var l=r("8GgXA");document.querySelector(".menu")&&new class{constructor(){this.taskbar=document.querySelector(".root__taskbar"),this.toggle=document.querySelector(".menu__toggle"),this.details=this.toggle.closest("details"),this.toggle.addEventListener("click",()=>this.toggleMenu()),this.init()}init(){this.toggle.tabIndex=0,this.toggle.setAttribute("role","button"),this.toggle.setAttribute("aria-expanded","false"),this.toggle.setAttribute("aria-controls","menu-content"),this.details.setAttribute("role","presentation")}toggleMenu(){let e=Array.from(document.querySelectorAll(".window"));this.ariaExpanded="false"|JSON.parse(this.toggle.getAttribute("aria-expanded")),this.toggle.setAttribute("aria-expanded",!this.ariaExpanded),e&&(this.taskbar.style.zIndex=(0,l.getMaxZIndex)(e)+1)}},document.querySelector(".bookmarks")&&new class{constructor(){this.list=document.querySelector(".bookmarks"),this.items=Array.from(this.list.querySelectorAll(".bookmark")),this.init()}init(){this.items.forEach(e=>{e.addEventListener("click",this.handleClick),e.setAttribute("data-clickable","")})}handleClick(e){e.currentTarget.querySelector("a[href]").click()}};let n=document.querySelector(".root");n.querySelector("main"),n.querySelector("header"),n.querySelector("footer");let o=n.querySelectorAll(".window");var l=r("8GgXA");let h=["Black Thatch","Blue Rivets","Bubbles","Carved Stone","Circles","Clouds","Forest","Gold Weave","Houndstooth","Metal Links","Pinstripe","Red Blocks","Sandstone","Setup","Stitches","Straw Mat","Tiles","Triangles","Waves"];new class{constructor(){this.setupElements(),this.loadWallpapers(),this.loadTheme(),this.init()}setupElements(){this.container=this.query(".settings"),this.popup=this.query(".popup",this.container),this.alert={container:this.query(".alert",this.container),firstFocusable:this.query("#alert-close-btn",this.container),closeButtons:this.query(".alert button",this.container,!0),heading:this.query(".alert__heading",this.container),message:this.query(".alert__message",this.container),outer:this.query("#alert-outer",this.container)},this.form=this.query("form",this.container),this.switcher=this.query(".switcher__wallpapers:not([data-placeholder])",this.form),this.buttons={open:this.query("#settings-open-btn",this.container),apply:this.query("#settings-apply-btn",this.container),cancel:this.query("#settings-cancel-btn",this.container),close:this.query("#settings-close-btn",this.container)},this.previewBox=this.query("#wallpaper-preview",this.popup),this.displaySelect=this.query("#display-select",this.form),this.themeSelect=this.query("#theme-select",this.form),this.browseInput=this.query("#browse-input",this.popup),this.dialogs=[this.popup,this.alert.container],this.wallpaperLabels=this.switcher.children}query(e,t=document,s=!1){return s?t.querySelectorAll(e):t.querySelector(e)}loadWallpapers(){localStorage.getItem("wallpapers")?this.wallpapers=JSON.parse(localStorage.getItem("wallpapers")):this.wallpapers=h.map(e=>({name:this.formatName(e),src:this.generateUrl(e),isEnabled:!1,isCustom:!1})),this.selectedWallpaper=this.wallpapers.find(e=>e.isEnabled)}loadTheme(){this.theme=document.documentElement.dataset.theme||"default",this.tempTheme=this.theme}formatName(e){return e.replaceAll(" ","-").replace(/.(png|jpeg|jpg)$/,"").toLowerCase()}generateUrl(e){return`/bookmarks98/${this.formatName(e)}.png`}init(){this.buttons.open.setAttribute("aria-expanded","false"),this.dialogs.forEach(e=>this.trapFocusInside(e)),this.bindEvents()}bindEvents(){this.buttons.open.addEventListener("click",()=>this.togglePopup(!0)),[this.buttons.close,this.buttons.cancel].forEach(e=>e.addEventListener("click",this.cancelSettings.bind(this))),this.handleWallpaperInput.bind(this),this.form.addEventListener("submit",this.handleSubmit.bind(this)),this.buttons.apply.addEventListener("click",this.applySettings.bind(this)),this.displaySelect.addEventListener("input",this.updateDisplayMode.bind(this)),this.browseInput.addEventListener("input",this.handleUpload.bind(this)),this.themeSelect.addEventListener("input",this.previewTheme.bind(this)),this.alert.closeButtons.forEach(e=>{e.addEventListener("click",this.hideAlert.bind(this))}),this.alert.outer.addEventListener("click",this.handleClickOutsideAlert.bind(this))}togglePopup(e){let t=e?this.popup:this.buttons.open,s=e?(0,l.getMaxZIndex)(o)+1:"auto";this.buttons.open.setAttribute("aria-expanded",`${e}`),this.popup.style.zIndex=s,this.popup.hidden=!e,t.focus(),this.loadWallpaperInputs(e)}trapFocusInside(e){let t=e.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])'),s=t[0],a=t[t.length-1];this.addFocusTrapListeners(s,a)}addFocusTrapListeners(e,t){let s=s=>{"Tab"!==s.key||(s.shiftKey&&s.target===e?(s.preventDefault(),t.focus()):s.shiftKey||s.target!==t||(s.preventDefault(),e.focus()))};[e,t].forEach(e=>e.addEventListener("keydown",s))}cancelSettings(){this.setTheme(!0),this.togglePopup(!1)}loadWallpaperInputs(e){this.wallpaperInputs=[...this.wallpaperLabels].map(e=>e.firstElementChild),e?this.wallpaperInputs.forEach(e=>e.addEventListener("input",e=>this.handleWallpaperInput(e))):this.wallpaperInputs.forEach(e=>e.removeEventListener("input",e=>this.handleWallpaperInput(e)))}handleWallpaperInput(e){let{target:t}=e;"radio"===t.type&&(this.updatePreview(t.value),this.displaySelect.dispatchEvent(new Event("input")))}updatePreview(e){this.setWallpaper(this.previewBox,e)}setWallpaper(e,t){if(this.selectedWallpaper=this.wallpapers.find(e=>e.name===t),this.selectedWallpaper){let{src:t}=this.selectedWallpaper;e.style.setProperty("--wallpaper",`url("${t}")`)}else e.style.setProperty("--wallpaper","none")}handleSubmit(e){e.preventDefault(),this.applySettings(),this.togglePopup(!1)}saveSettings(){this.setLocalStorageItem("wallpapers",this.wallpapers),this.setLocalStorageItem("display-mode",this.displayMode),this.setLocalStorageItem("preview-ratio",this.previewRatio),this.setLocalStorageItem("switcher",this.switcher.innerHTML),this.setLocalStorageItem("theme",this.theme)}setLocalStorageItem(e,t){if(t){t="object"==typeof t?JSON.stringify(t):t;try{localStorage.setItem(e,t)}catch(e){if("QuotaExceededError"===e.name)console.error("Local storage is full. Please free up some space.");else throw e}}}applySettings(){let e=[...this.wallpaperInputs].find(e=>e.checked),t=e.value;this.displayMode=this.displaySelect.value,this.setWallpaper(n,t),this.setDisplayStyle(n,this.displayMode),this.setActiveWallpaper(t),this.resetAppliedClass(e),this.setTheme(!1),this.saveSettings()}resetAppliedClass(e=null){[...this.wallpaperInputs].forEach(e=>e.classList.remove("applied")),e&&e.classList.add("applied")}updateDisplayMode(e){this.displayMode=e.currentTarget.value,this.setDisplayStyle(this.previewBox,this.displayMode)}async setDisplayStyle(e,t){Object.entries({center:{size:"auto",repeat:"no-repeat",position:"center"},tile:{size:"auto",repeat:"repeat",position:"auto"},stretch:{size:"100% 100%",repeat:"no-repeat",position:"auto"}}[t]).forEach(([t,s])=>e.style.setProperty(`--${t}`,s)),this.previewRatio="stretch"!==t?await this.getPreviewRatio():"100% 100%",e.style.setProperty("--preview-size",this.previewRatio)}loadImage(e){return new Promise((t,s)=>{let a=document.createElement("img");a.onload=()=>t(a),a.onerror=s,a.src=e})}calculatePreviewRatio(e,t,s){let{naturalHeight:a,naturalWidth:r}=e;return e.remove(),`${Math.round(100*r/t)}% ${Math.round(100*a/s)}%`}async getPreviewRatio(){let e=n.offsetWidth,t=n.offsetHeight;if(this.selectedWallpaper)try{let s=await this.loadImage(this.selectedWallpaper.src);return this.calculatePreviewRatio(s,e,t)}catch(e){console.error("Failed to load image:",e)}return"100% 100%"}async handleUpload(e){let t=e.target.files[0],s=this.formatName(t.name),a=t.size;if(!this.validateFile(a,s)){this.browseInput.value=null;return}try{let e=await this.readFile(t);this.addCustomWallpaper(t,e)}catch(e){console.error("Error reading file:",e)}}addCustomWallpaper(e,t){let s={name:this.formatName(e.name),src:t,isEnabled:!1,isCustom:!0};this.wallpapers.push(s),this.setLocalStorageItem("wallpapers",this.wallpapers),this.updateSwitcher(s)}readFile(e){return new Promise((t,s)=>{let a=new FileReader;a.onload=e=>{t(e.target.result)},a.onerror=s,a.readAsDataURL(e)})}setActiveWallpaper(e){this.selectedWallpaper=this.wallpapers.find(t=>t.name===e),this.wallpapers.forEach(e=>{e.isEnabled=e===this.selectedWallpaper})}validateFile(e,t){let s=this.wallpapers.find(e=>e.name===t);return e>1048576?(this.showAlert("File Size Exceeds Limit","The file size exceeds the limit of 1MB. Please upload a smaller file."),!1):!s||(this.showAlert("Duplicate File Name",`A file named "${t}" has already been uploaded. Please upload a different file.`),!1)}showAlert(e,t){this.alert.heading.innerText=e,this.alert.message.innerText=t,this.alert.outer.hidden=!1,this.alert.container.focus()}hideAlert(){this.alert.outer.hidden=!0,this.browseInput.focus()}handleClickOutsideAlert(e){e.target===this.alert.outer&&this.hideAlert()}updateSwitcher(e){let t=document.createElement("label");t.classList.add("wallpaper"),t.setAttribute("for",this.formatName(e.name));let s=document.createElement("input");s.type="radio",s.name="wallpaper",s.value=this.formatName(e.name),s.id=this.formatName(e.name),s.checked=!0;let a=document.createElement("img");a.src=this.switcher.querySelector("img").src;let r=document.createElement("span");r.innerText=e.name,t.append(s,a,r),this.switcher.appendChild(t),s.focus(),this.loadWallpaperInputs(!0),s.dispatchEvent(new Event("input")),this.setLocalStorageItem("switcher",this.switcher.innerHTML)}previewTheme(e){this.tempTheme=e.currentTarget.value;let t=`/bookmarks98/${this.tempTheme}.png`;n.style.setProperty("--theme-preview",`url("${t}")`)}setTheme(e){let t=e?this.theme:this.tempTheme,s=`/bookmarks98/${t}.png`;n.style.setProperty("--theme-preview",`url("${s}")`),this.theme=t,this.tempTheme=this.theme,this.themeSelect.value=this.theme,document.documentElement.dataset.theme=this.theme}};var l=r("8GgXA");document.querySelector(".window")&&new class{constructor(){this.windows=document.querySelectorAll(".window"),this.windows.forEach(e=>{e.addEventListener("click",this.handleClick.bind(this))})}handleClick(e){let{currentTarget:t}=e;t.style.zIndex=(0,l.getMaxZIndex)(this.windows)+1}},r("dTwV1").then(e=>{e.default()})})();
//# sourceMappingURL=main.js.map
