(()=>{function e(e,t,a,s){Object.defineProperty(e,t,{get:a,set:s,enumerable:!0,configurable:!0})}var t=globalThis,a={},s={},r=t.parcelRequireb18d;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in s){var t=s[e];delete s[e];var r={id:e,exports:{}};return a[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){s[e]=t},t.parcelRequireb18d=r);var i=r.register;i("kI8SP",function(t,a){e(t.exports,"register",()=>s,e=>s=e),e(t.exports,"resolve",()=>r,e=>r=e);var s,r,i=new Map;s=function(e,t){for(var a=0;a<t.length-1;a+=2)i.set(t[a],{baseUrl:e,path:t[a+1]})},r=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),i("hIarR",function(t,a){e(t.exports,"getBundleURL",()=>s,e=>s=e);var s,r={};s=function(e){var t=r[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),r[e]=t),t}}),i("dTwV1",function(e,t){e.exports=r("dNLwc")(r("kI8SP").resolve("eM6PU")).then(()=>r("6vhjD"))}),i("dNLwc",function(e,t){var a=r("7lV8K");e.exports=a(function(e){return new Promise(function(t,a){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var s=document.createElement("link");s.href=e,s.rel="preload",s.as="script",document.head.appendChild(s);var r=document.createElement("script");r.async=!0,r.type="text/javascript",r.src=e,r.onerror=function(t){var s=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));r.onerror=r.onload=null,r.remove(),a(s)},r.onload=function(){r.onerror=r.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(r)})})}),i("7lV8K",function(e,t){var a={},s={},r={};e.exports=function(e,t){return function(i){var l=function(e){switch(e){case"preload":return s;case"prefetch":return r;default:return a}}(t);return l[i]?l[i]:l[i]=e.apply(null,arguments).catch(function(e){throw delete l[i],e})}}}),r("kI8SP").register(r("hIarR").getBundleURL("cybPK"),JSON.parse('["cybPK","main.js","eM6PU","../dragAndDrop.createDraggables.ca670dbb.js"]')),document.querySelector(".menu")&&new class{constructor(){this.toggle=document.querySelector(".menu__toggle"),this.details=this.toggle.closest("details"),this.toggle.addEventListener("click",()=>this.toggleMenu()),this.init()}init(){this.toggle.tabIndex=0,this.toggle.setAttribute("role","button"),this.toggle.setAttribute("aria-expanded","false"),this.toggle.setAttribute("aria-controls","menu-content"),this.details.setAttribute("role","presentation")}toggleMenu(){let e=Array.from(document.querySelectorAll(".window"));this.ariaExpanded="false"|JSON.parse(this.toggle.getAttribute("aria-expanded")),this.toggle.setAttribute("aria-expanded",!this.ariaExpanded),e&&e.forEach(e=>e.style.zIndex=0)}},document.querySelector(".bookmarks")&&new class{constructor(){this.list=document.querySelector(".bookmarks"),this.items=Array.from(this.list.querySelectorAll(".bookmark")),this.init()}init(){this.items.forEach(e=>{e.addEventListener("click",this.handleClick),e.setAttribute("data-clickable","")})}handleClick(e){e.currentTarget.querySelector("a[href]").click()}};let l=document.querySelector(".root"),n=l.querySelector("main"),o=l.querySelector("header"),p=l.querySelector("footer"),h=["Black Thatch","Blue Rivets","Bubbles","Carved Stone","Circles","Clouds","Forest","Gold Weave","Houndstooth","Metal Links","Pinstripe","Red Blocks","Sandstone","Setup","Stitches","Straw Mat","Tiles","Triangles","Waves"];new class{constructor(){this.setupElements(),this.loadWallpapers(),this.loadTheme(),this.initPopup()}setupElements(){this.container=this.query(".settings"),this.popup=this.query(".popup",this.container),this.form=this.query("form",this.container),this.switcher=this.query(".switcher__wallpapers:not([data-placeholder])",this.form),this.buttons={open:this.query("#settings-open-btn",this.container),apply:this.query("#settings-apply-btn",this.container),cancel:this.query("#settings-cancel-btn",this.container),close:this.query("#settings-close-btn",this.container)},this.previewBox=this.query("#wallpaper-preview",this.popup),this.displaySelect=this.query("#display-select",this.form),this.themeSelect=this.query("#theme-select",this.form),this.browseInput=this.query("#browse-input",this.popup),this.wallpaperLabels=this.switcher.children}query(e,t=document,a=!1){return a?t.querySelectorAll(e):t.querySelector(e)}loadWallpapers(){localStorage.getItem("wallpapers")?this.wallpapers=JSON.parse(localStorage.getItem("wallpapers")):this.wallpapers=h.map(e=>({name:this.formatName(e),src:this.generateUrl(e),isEnabled:!1,isCustom:!1})),this.selectedWallpaper=this.wallpapers.find(e=>e.isEnabled)}loadTheme(){this.theme=document.documentElement.dataset.theme||"default",this.tempTheme=this.theme}formatName(e){return e.replaceAll(" ","-").replace(/.(png|jpeg|jpg)$/,"").toLowerCase()}generateUrl(e){return`/bookmarks98/${this.formatName(e)}.png`}initPopup(){this.buttons.open.setAttribute("aria-expanded","false"),this.bindEvents()}bindEvents(){this.buttons.open.addEventListener("click",()=>this.togglePopup(!0)),[this.buttons.close,this.buttons.cancel].forEach(e=>e.addEventListener("click",this.cancelSettings.bind(this))),this.handleWallpaperInput.bind(this),this.form.addEventListener("submit",this.handleSubmit.bind(this)),this.buttons.apply.addEventListener("click",this.applySettings.bind(this)),this.displaySelect.addEventListener("input",this.updateDisplayMode.bind(this)),this.browseInput.addEventListener("input",this.handleUpload.bind(this)),this.themeSelect.addEventListener("input",this.previewTheme.bind(this))}togglePopup(e){let t=[n,o,p,this.buttons.open],a=e?this.popup:this.buttons.open;this.buttons.open.setAttribute("aria-expanded",`${e}`),this.popup.hidden=!e,t.forEach(t=>this.toggleInertState(e,t)),a.focus(),this.loadWallpaperInputs(e)}cancelSettings(){this.setTheme(!0),this.togglePopup(!1)}toggleInertState(e,t){let a=t.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])');t.setAttribute("aria-hidden",`${e}`),a.forEach(t=>t.tabIndex=Number(e))}loadWallpaperInputs(e){this.wallpaperInputs=[...this.wallpaperLabels].map(e=>e.firstElementChild),e?this.wallpaperInputs.forEach(e=>e.addEventListener("input",e=>this.handleWallpaperInput(e))):this.wallpaperInputs.forEach(e=>e.removeEventListener("input",e=>this.handleWallpaperInput(e)))}handleWallpaperInput(e){let{target:t}=e;"radio"===t.type&&(this.updatePreview(t.value),this.displaySelect.dispatchEvent(new Event("input")))}updatePreview(e){this.setWallpaper(this.previewBox,e)}setWallpaper(e,t){if(this.selectedWallpaper=this.wallpapers.find(e=>e.name===t),this.selectedWallpaper){let{src:t}=this.selectedWallpaper;e.style.setProperty("--wallpaper",`url("${t}")`)}else e.style.setProperty("--wallpaper","none")}handleSubmit(e){e.preventDefault(),this.applySettings(),this.togglePopup(!1)}saveSettings(){this.setLocalStorageItem("wallpapers",this.wallpapers),this.setLocalStorageItem("display-mode",this.displayMode),this.setLocalStorageItem("preview-ratio",this.previewRatio),this.setLocalStorageItem("switcher",this.switcher.innerHTML),this.setLocalStorageItem("theme",this.theme)}setLocalStorageItem(e,t){if(t){t="object"==typeof t?JSON.stringify(t):t;try{localStorage.setItem(e,t)}catch(e){if("QuotaExceededError"===e.name)console.error("Local storage is full. Please free up some space.");else throw e}}}applySettings(){let e=[...this.wallpaperInputs].find(e=>e.checked),t=e.value;this.displayMode=this.displaySelect.value,this.setWallpaper(l,t),this.setDisplayStyle(l,this.displayMode),this.setActiveWallpaper(t),this.resetAppliedClass(e),this.setTheme(!1),this.saveSettings()}resetAppliedClass(e=null){[...this.wallpaperInputs].forEach(e=>e.classList.remove("applied")),e&&e.classList.add("applied")}updateDisplayMode(e){this.displayMode=e.currentTarget.value,this.setDisplayStyle(this.previewBox,this.displayMode)}async setDisplayStyle(e,t){Object.entries({center:{size:"auto",repeat:"no-repeat",position:"center"},tile:{size:"auto",repeat:"repeat",position:"auto"},stretch:{size:"100% 100%",repeat:"no-repeat",position:"auto"}}[t]).forEach(([t,a])=>e.style.setProperty(`--${t}`,a)),this.previewRatio="stretch"!==t?await this.getPreviewRatio():"100% 100%",e.style.setProperty("--preview-size",this.previewRatio)}loadImage(e){return new Promise((t,a)=>{let s=document.createElement("img");s.onload=()=>t(s),s.onerror=a,s.src=e})}calculatePreviewRatio(e,t,a){let{naturalHeight:s,naturalWidth:r}=e;return e.remove(),`${Math.round(100*r/t)}% ${Math.round(100*s/a)}%`}async getPreviewRatio(){let e=l.offsetWidth,t=l.offsetHeight;if(this.selectedWallpaper)try{let a=await this.loadImage(this.selectedWallpaper.src);return this.calculatePreviewRatio(a,e,t)}catch(e){console.error("Failed to load image:",e)}return"100% 100%"}async handleUpload(e){let t=e.target.files[0],a=this.formatName(t.name),s=t.size;if(this.validateFile(s,a))try{let e=await this.readFile(t);this.addCustomWallpaper(t,e)}catch(e){console.error("Error reading file:",e)}}addCustomWallpaper(e,t){let a={name:this.formatName(e.name),src:t,isEnabled:!1,isCustom:!0};this.wallpapers.push(a),this.setLocalStorageItem("wallpapers",this.wallpapers),this.updateSwitcher(a)}readFile(e){return new Promise((t,a)=>{let s=new FileReader;s.onload=e=>{t(e.target.result)},s.onerror=a,s.readAsDataURL(e)})}setActiveWallpaper(e){this.selectedWallpaper=this.wallpapers.find(t=>t.name===e),this.wallpapers.forEach(e=>{e.isEnabled=e===this.selectedWallpaper})}validateFile(e,t){let a=this.wallpapers.find(e=>e.name===t);return e>1048576?(alert("The file size exceeds the limit of 1MB. Please upload a smaller file."),!1):!a||(alert(`A file named "${t}" has already been uploaded. Please upload a different file.`),!1)}updateSwitcher(e){let t=document.createElement("label");t.classList.add("wallpaper"),t.setAttribute("for",this.formatName(e.name));let a=document.createElement("input");a.type="radio",a.name="wallpaper",a.value=this.formatName(e.name),a.id=this.formatName(e.name),a.checked=!0;let s=document.createElement("img");s.src=this.switcher.querySelector("img").src;let r=document.createElement("span");r.innerText=e.name,t.append(a,s,r),this.switcher.appendChild(t),a.focus(),this.loadWallpaperInputs(!0),a.dispatchEvent(new Event("input")),this.setLocalStorageItem("switcher",this.switcher.innerHTML)}previewTheme(e){this.tempTheme=e.currentTarget.value,document.documentElement.dataset.theme=this.tempTheme}setTheme(e){let t=e?this.theme:this.tempTheme;this.theme=t,this.tempTheme=this.theme,this.themeSelect.value=this.theme,document.documentElement.dataset.theme=this.theme}},r("dTwV1").then(e=>{e.default()})})();
//# sourceMappingURL=main.js.map
