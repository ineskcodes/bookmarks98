!function(){function e(e,t,i,s){Object.defineProperty(e,t,{get:i,set:s,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},r=t.parcelRequireb18d;null==r&&((r=function(e){if(e in i)return i[e].exports;if(e in s){var t=s[e];delete s[e];var r={id:e,exports:{}};return i[e]=r,t.call(r.exports,r,r.exports),r.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){s[e]=t},t.parcelRequireb18d=r);var a=r.register;a("02gTD",function(t,i){e(t.exports,"register",function(){return s},function(e){return s=e}),e(t.exports,"resolve",function(){return r},function(e){return r=e});var s,r,a=new Map;s=function(e,t){for(var i=0;i<t.length-1;i+=2)a.set(t[i],{baseUrl:e,path:t[i+1]})},r=function(e){var t=a.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),a("3E9rI",function(t,i){e(t.exports,"getBundleURL",function(){return s},function(e){return s=e});var s,r={};s=function(e){var t=r[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),r[e]=t),t}}),a("1NUJT",function(t,i){e(t.exports,"default",function(){return n});var s=r("cbNRq");class a{constructor(){this.taskbar=document.querySelector(".root__taskbar"),this.toggle=document.querySelector(".menu__toggle"),this.details=this.toggle.closest("details"),this.details.addEventListener("toggle",this.toggleMenu.bind(this)),this.isOpen=this.details.open,this.init()}init(){this.toggle.tabIndex=0,this.toggle.setAttribute("role","button"),this.toggle.setAttribute("aria-expanded",this.isOpen),this.toggle.setAttribute("aria-controls","menu-content"),this.details.setAttribute("role","presentation")}toggleMenu(e){let t=Array.from(document.querySelectorAll(".window"));this.isOpen="open"===e.newState,this.toggle.setAttribute("aria-expanded",this.isOpen),t&&(this.taskbar.style.zIndex=(0,s.getMaxZIndex)(t)+1)}}document.querySelector(".menu")&&new a;var n=a}),a("cbNRq",function(t,i){e(t.exports,"getDraggableType",function(){return s}),e(t.exports,"getDraggableItemName",function(){return r}),e(t.exports,"checkIfOverlap",function(){return a}),e(t.exports,"populateStorage",function(){return n}),e(t.exports,"getLastPositionFromLocalStorage",function(){return l}),e(t.exports,"getMaxZIndex",function(){return o});let s=e=>e.target.dataset.draggable,r=e=>e.target.dataset.item,a=(e,t)=>"icon"!==s(e)?null:t.some(t=>e.hitTest(t,"25%")),n=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},l=e=>JSON.parse(localStorage.getItem(`${e.target.dataset.item}-position`)),o=([e,t])=>{let i=[getComputedStyle(e).zIndex,getComputedStyle(t).zIndex];return(i=i.map(e=>"auto"===e?0:parseInt(e))).reduce((e,t)=>Math.max(e,t))}}),a("iofW6",function(t,i){e(t.exports,"default",function(){return r});class s{constructor(){this.list=document.querySelector(".bookmarks"),this.items=Array.from(this.list.querySelectorAll(".bookmark")),this.init()}init(){this.items.forEach(e=>{e.addEventListener("click",this.handleClick),e.setAttribute("data-clickable","")})}handleClick(e){e.currentTarget.querySelector("a[href]").click()}}document.querySelector(".bookmarks")&&new s;var r=s}),a("bATWL",function(t,i){e(t.exports,"default",function(){return n});var s=r("cbNRq");class a{constructor(){this.mainWindow=document.querySelector(".window.main"),this.settingsWindow=document.querySelector(".popup.window"),this.alertWindow=document.querySelector(".alert.window"),this.windows=[this.mainWindow,this.settingsWindow,this.alertWindow],this.init()}init(){this.mainWindow.style.zIndex=(0,s.getMaxZIndex)(this.windows)+1,this.windows.forEach(e=>{e&&e.addEventListener("mousedown",this.handleClick.bind(this))})}handleClick(e){let{currentTarget:t}=e;t.style.zIndex=(0,s.getMaxZIndex)(this.windows)+1,t===this.alertWindow&&(t.parentElement.style.zIndex=(0,s.getMaxZIndex)(this.windows)+1)}}document.querySelector(".window")&&new a;var n=a}),a("2JimL",function(e,t){e.exports=r("4ReQy")(r("02gTD").resolve("bXdr1")).then(()=>r("Jj56w"))}),a("4ReQy",function(e,t){var i=r("igfKR");e.exports=i(function(e){return new Promise(function(t,i){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var s=document.createElement("link");s.href=e,s.rel="preload",s.as="script",document.head.appendChild(s);var r=document.createElement("script");r.async=!0,r.type="text/javascript",r.src=e,r.onerror=function(t){var s=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));r.onerror=r.onload=null,r.remove(),i(s)},r.onload=function(){r.onerror=r.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(r)})})}),a("igfKR",function(e,t){var i={},s={},r={};e.exports=function(e,t){return function(a){var n=function(e){switch(e){case"preload":return s;case"prefetch":return r;default:return i}}(t);return n[a]?n[a]:n[a]=e.apply(null,arguments).catch(function(e){throw delete n[a],e})}}}),r("02gTD").register(r("3E9rI").getBundleURL("jOvkA"),JSON.parse('["jOvkA","main.js","bXdr1","../dragAndDrop.createDraggables.b62afc9b.js"]')),r("1NUJT"),r("iofW6");let n=document.querySelector(".root");n.querySelector("main"),n.querySelector("header"),n.querySelector("footer"),n.querySelectorAll(".window");let l=["Black Thatch","Blue Rivets","Bubbles","Carved Stone","Circles","Clouds","Forest","Gold Weave","Houndstooth","Metal Links","Pinstripe","Red Blocks","Sandstone","Setup","Stitches","Straw Mat","Tiles","Triangles","Waves"];new class{constructor(){this.setupElements(),this.loadWallpapers(),this.loadTheme(),this.init()}setupElements(){this.container=this.query(".settings"),this.popup=this.query(".popup",this.container),this.alert={container:this.query(".alert",this.container),firstFocusable:this.query("#alert-close-btn",this.container),closeButtons:this.query(".alert button",this.container,!0),heading:this.query(".alert__heading",this.container),message:this.query(".alert__message",this.container),outer:this.query("#alert-outer",this.container)},this.form=this.query("form",this.container),this.switcher=this.query(".switcher__wallpapers:not([data-placeholder])",this.form),this.buttons={open:this.query("#settings-open-btn",this.container),apply:this.query("#settings-apply-btn",this.container),cancel:this.query("#settings-cancel-btn",this.container),close:this.query("#settings-close-btn",this.container)},this.previewBox=this.query("#wallpaper-preview",this.popup),this.displaySelect=this.query("#display-select",this.form),this.themeSelect=this.query("#theme-select",this.form),this.browseInput=this.query("#browse-input",this.popup),this.dialogs=[this.popup,this.alert.container],this.wallpaperLabels=this.switcher.children,this.pathPrefix=location.pathname.match(/^\/.+?\//)}query(e,t=document,i=!1){return i?t.querySelectorAll(e):t.querySelector(e)}loadWallpapers(){localStorage.getItem("wallpapers")?this.wallpapers=JSON.parse(localStorage.getItem("wallpapers")):this.wallpapers=l.map(e=>({name:this.formatName(e),src:this.generateUrl(e),isEnabled:!1,isCustom:!1})),this.selectedWallpaper=this.wallpapers.find(e=>e.isEnabled)}loadTheme(){this.theme=document.documentElement.dataset.theme||"default",this.tempTheme=this.theme}formatName(e){return e.replaceAll(" ","-").replace(/.(png|jpeg|jpg)$/,"").toLowerCase()}generateUrl(e){return`${this.pathPrefix}${this.formatName(e)}.png`}init(){this.buttons.open.setAttribute("aria-expanded","false"),this.dialogs.forEach(e=>this.trapFocusInside(e)),this.bindEvents()}bindEvents(){this.buttons.open.addEventListener("click",()=>this.togglePopup(!0)),[this.buttons.close,this.buttons.cancel].forEach(e=>e.addEventListener("click",this.cancelSettings.bind(this))),this.handleWallpaperInput.bind(this),this.form.addEventListener("submit",this.handleSubmit.bind(this)),this.buttons.apply.addEventListener("click",this.applySettings.bind(this)),this.displaySelect.addEventListener("input",this.updateDisplayMode.bind(this)),this.browseInput.addEventListener("input",this.handleUpload.bind(this)),this.themeSelect.addEventListener("input",this.previewTheme.bind(this)),this.alert.closeButtons.forEach(e=>{e.addEventListener("click",this.hideAlert.bind(this))}),this.alert.outer.addEventListener("click",this.handleClickOutsideAlert.bind(this))}togglePopup(e){let t=e?this.popup:this.buttons.open;this.buttons.open.setAttribute("aria-expanded",`${e}`),this.popup.hidden=!e,t.focus(),this.loadWallpaperInputs(e),e&&this.popup.dispatchEvent(new Event("mousedown"))}trapFocusInside(e){let t=e.querySelectorAll('a[href], button, input, textarea, select, [tabindex]:not([tabindex="-1"])'),i=t[0],s=t[t.length-1];this.addFocusTrapListeners(i,s)}addFocusTrapListeners(e,t){let i=i=>{"Tab"!==i.key||(i.shiftKey&&i.target===e?(i.preventDefault(),t.focus()):i.shiftKey||i.target!==t||(i.preventDefault(),e.focus()))};[e,t].forEach(e=>e.addEventListener("keydown",i))}cancelSettings(){this.setTheme(!0),this.togglePopup(!1)}loadWallpaperInputs(e){this.wallpaperInputs=[...this.wallpaperLabels].map(e=>e.firstElementChild),e?this.wallpaperInputs.forEach(e=>e.addEventListener("input",e=>this.handleWallpaperInput(e))):this.wallpaperInputs.forEach(e=>e.removeEventListener("input",e=>this.handleWallpaperInput(e)))}handleWallpaperInput(e){let{target:t}=e;"radio"===t.type&&(this.updatePreview(t.value),this.displaySelect.dispatchEvent(new Event("input")))}updatePreview(e){this.setWallpaper(this.previewBox,e)}setWallpaper(e,t){if(this.selectedWallpaper=this.wallpapers.find(e=>e.name===t),this.selectedWallpaper){let{src:t}=this.selectedWallpaper;e.style.setProperty("--wallpaper",`url("${t}")`)}else e.style.setProperty("--wallpaper","none")}handleSubmit(e){e.preventDefault(),this.applySettings(),this.togglePopup(!1)}saveSettings(){this.setLocalStorageItem("wallpapers",this.wallpapers),this.setLocalStorageItem("display-mode",this.displayMode),this.setLocalStorageItem("preview-ratio",this.previewRatio),this.setLocalStorageItem("switcher",this.switcher.innerHTML),this.setLocalStorageItem("theme",this.theme)}setLocalStorageItem(e,t){if(t){t="object"==typeof t?JSON.stringify(t):t;try{localStorage.setItem(e,t)}catch(e){if("QuotaExceededError"===e.name)console.error("Local storage is full. Please free up some space.");else throw e}}}applySettings(){let e=[...this.wallpaperInputs].find(e=>e.checked),t=e.value;this.displayMode=this.displaySelect.value,this.setWallpaper(n,t),this.setDisplayStyle(n,this.displayMode),this.setActiveWallpaper(t),this.resetAppliedClass(e),this.setTheme(!1),this.saveSettings()}resetAppliedClass(e=null){[...this.wallpaperInputs].forEach(e=>e.classList.remove("applied")),e&&e.classList.add("applied")}updateDisplayMode(e){this.displayMode=e.currentTarget.value,this.setDisplayStyle(this.previewBox,this.displayMode)}async setDisplayStyle(e,t){Object.entries({center:{size:"auto",repeat:"no-repeat",position:"center"},tile:{size:"auto",repeat:"repeat",position:"auto"},stretch:{size:"100% 100%",repeat:"no-repeat",position:"auto"}}[t]).forEach(([t,i])=>e.style.setProperty(`--${t}`,i)),this.previewRatio="stretch"!==t?await this.getPreviewRatio():"100% 100%",e.style.setProperty("--preview-size",this.previewRatio)}loadImage(e){return new Promise((t,i)=>{let s=document.createElement("img");s.onload=()=>t(s),s.onerror=i,s.src=e})}calculatePreviewRatio(e,t,i){let{naturalHeight:s,naturalWidth:r}=e;return e.remove(),`${Math.round(100*r/t)}% ${Math.round(100*s/i)}%`}async getPreviewRatio(){let e=n.offsetWidth,t=n.offsetHeight;if(this.selectedWallpaper)try{let i=await this.loadImage(this.selectedWallpaper.src);return this.calculatePreviewRatio(i,e,t)}catch(e){console.error("Failed to load image:",e)}return"100% 100%"}async handleUpload(e){let t=e.target.files[0],i=this.formatName(t.name),s=t.size;if(!this.validateFile(s,i)){this.browseInput.value=null;return}try{let e=await this.readFile(t);this.addCustomWallpaper(t,e)}catch(e){console.error("Error reading file:",e)}}addCustomWallpaper(e,t){let i={name:this.formatName(e.name),src:t,isEnabled:!1,isCustom:!0};this.wallpapers.push(i),this.setLocalStorageItem("wallpapers",this.wallpapers),this.updateSwitcher(i)}readFile(e){return new Promise((t,i)=>{let s=new FileReader;s.onload=e=>{t(e.target.result)},s.onerror=i,s.readAsDataURL(e)})}setActiveWallpaper(e){this.selectedWallpaper=this.wallpapers.find(t=>t.name===e),this.wallpapers.forEach(e=>{e.isEnabled=e===this.selectedWallpaper})}validateFile(e,t){let i=this.wallpapers.find(e=>e.name===t);return e>1048576?(this.showAlert("File Size Exceeds Limit","The file size exceeds the limit of 1MB. Please upload a smaller file."),!1):!i||(this.showAlert("Duplicate File Name",`A file named "${t}" has already been uploaded. Please upload a different file.`),!1)}showAlert(e,t){this.alert.heading.innerText=e,this.alert.message.innerText=t,this.alert.outer.hidden=!1,this.alert.container.focus(),this.alert.container.dispatchEvent(new Event("mousedown"))}hideAlert(){this.alert.outer.hidden=!0,this.browseInput.focus()}handleClickOutsideAlert(e){e.target===this.alert.outer&&this.hideAlert()}updateSwitcher(e){let t=document.createElement("label");t.classList.add("wallpaper"),t.setAttribute("for",this.formatName(e.name));let i=document.createElement("input");i.type="radio",i.name="wallpaper",i.value=this.formatName(e.name),i.id=this.formatName(e.name),i.checked=!0;let s=document.createElement("img");s.src=this.switcher.querySelector("img").src;let r=document.createElement("span");r.innerText=e.name,t.append(i,s,r),this.switcher.appendChild(t),i.focus(),this.loadWallpaperInputs(!0),i.dispatchEvent(new Event("input")),this.setLocalStorageItem("switcher",this.switcher.innerHTML)}previewTheme(e){this.tempTheme=e.currentTarget.value;let t=`${this.pathPrefix}${this.tempTheme}.png`;n.style.setProperty("--theme-preview",`url("${t}")`)}setTheme(e){let t=e?this.theme:this.tempTheme,i=`${this.pathPrefix}${t}.png`;n.style.setProperty("--theme-preview",`url("${i}")`),this.theme=t,this.tempTheme=this.theme,this.themeSelect.value=this.theme,document.documentElement.dataset.theme=this.theme}},r("bATWL"),Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)>=700&&r("2JimL").then(e=>{e.default()})}();
//# sourceMappingURL=main.js.map
