!function(){function e(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequireb18d,i=t.register;i("1FWyb",function(i,n){e(i.exports,"default",function(){return a});var o=t("jsWSP"),r=t("cbNRq");class s{constructor(){this.windows=Array.from(document.querySelectorAll(".window")),this.minimizeButtons=Array.from(document.querySelectorAll(".minimize-btn")),this.feedbackRegion=document.querySelector("#minimize-feedback"),this.init()}init(){this.windows.forEach(e=>e.addEventListener("toggleminimize",this.toggleMinimize.bind(this))),this.minimizeButtons.forEach(e=>e.addEventListener("click",this.handleMinimizeButtonClick.bind(this)))}createObserver(e){return new Promise((t,i)=>{new IntersectionObserver((i,n)=>{t(i[0].boundingClientRect),n.unobserve(e)}).observe(e)})}getUntransformedBounds(e){return{x:e.offsetLeft+e.offsetParent.offsetLeft,y:e.offsetTop+e.offsetParent.offsetTop,width:e.offsetWidth}}getTransformValues(e,t){return{x:t.x-e.x,y:t.y-e.y,scale:(t.width/e.width).toFixed(2)}}toggleStates(e,t){let i=!t.isMinimized;e.taskButton.setAttribute("aria-pressed",!t.isPressed),e.windowEl.setAttribute("data-minimized",!t.isMinimized),(0,r.updatePageHookWindow)(e.windowEl,i)}checkIfAnimationIsActive(){let e=!1;return this.minimizeTween&&this.unminimizeTween&&(e=this.minimizeTween.isActive()||this.unminimizeTween.isActive()),e}async toggleMinimize(e){if(this.checkIfAnimationIsActive())return;let{detail:t}=e,{windowEl:i,isPressed:n}=t,o=(0,r.getStateBoolean)(i,"data-minimized"),s=(0,r.getCorrespondingTaskButton)(i),a=await this.createObserver(s),u=await this.createObserver(i),d=this.getUntransformedBounds(i),l={minimizeValues:this.getTransformValues(d,a),unminimizeValues:this.getTransformValues(d,u)};n&&!o?(this.minimize(i,l),this.toggleStates({taskButton:s,windowEl:i},{isPressed:n,isMinimized:o})):(this.unminimize(i,l),this.toggleStates({taskButton:s,windowEl:i},{isPressed:n,isMinimized:o}),i.dispatchEvent(new Event("mousedown"))),this.announceFeedback(i,!o),s.focus()}announceFeedback(e,t){let i=e.querySelector(".window__heading").textContent;this.feedbackRegion.textContent=`${i} window ${t?"":"un"}minimized.`}createTweenOptions({values:e,duration:t=.3,autoAlpha:i=0,clearProps:n=null}){return{duration:t,x:e.x,y:e.y,scaleX:e.scale?e.scale:1,scaleY:e.scale?e.scale:1,transformOrigin:"left top",autoAlpha:i,clearProps:n||"clip-path",onStart:()=>document.documentElement.setAttribute("data-animating",""),onComplete:()=>document.documentElement.removeAttribute("data-animating")}}minimize(e,t){let{minimizeValues:i}=t,n=e.getAttribute("style");!0===window.matchMedia("(prefers-reduced-motion: reduce)")||!0===window.matchMedia("(prefers-reduced-motion: reduce)").matches||(this.minimizeTween=(0,o.default).to(e,this.createTweenOptions({values:i,clearProps:"all"})),this.minimizeTween.play().then(()=>{e.setAttribute("style",n),e.style.visibility="hidden"}))}unminimize(e,t){let{minimizeValues:i,unminimizeValues:n}=t;!0===window.matchMedia("(prefers-reduced-motion: reduce)")||!0===window.matchMedia("(prefers-reduced-motion: reduce)").matches||(this.unminimizeTween=(0,o.default).timeline().to(e,this.createTweenOptions({values:i,duration:0})).to(e,this.createTweenOptions({values:n,duration:.3,autoAlpha:1})))}handleMinimizeButtonClick(e){let t=e.currentTarget,i=!!e.pageX,n=t.closest(".window"),o=(0,r.getCorrespondingTaskButton)(n),s=!(0,r.getStateBoolean)(o);(0,r.removeOutlineFromElement)(o,i),n.dispatchEvent(new CustomEvent("toggleminimize",{detail:{windowEl:n,isPressed:s}}))}}new s;var a=s}),i("cbNRq",function(t,i){e(t.exports,"getDraggableType",function(){return n}),e(t.exports,"getDraggableItemName",function(){return o}),e(t.exports,"checkIfOverlap",function(){return r}),e(t.exports,"populateStorage",function(){return s}),e(t.exports,"getLastPositionFromLocalStorage",function(){return a}),e(t.exports,"getMaxZIndex",function(){return u}),e(t.exports,"getStateBoolean",function(){return d}),e(t.exports,"getCorrespondingTaskButton",function(){return l}),e(t.exports,"getCorrespondingWindow",function(){return m}),e(t.exports,"removeOutlineFromElement",function(){return c}),e(t.exports,"updatePageHookWindow",function(){return f});let n=e=>e.target.dataset.draggable,o=e=>e.target.dataset.item,r=(e,t)=>"icon"!==n(e)?null:(t=t.filter(e=>"true"!==e.dataset.minimized)).some(t=>e.hitTest(t,"25%")),s=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},a=e=>JSON.parse(localStorage.getItem(`${e.target.dataset.item}-position`)),u=([e,t])=>{let i=[getComputedStyle(e).zIndex,getComputedStyle(t).zIndex];return(i=i.map(e=>"auto"===e?0:parseInt(e))).reduce((e,t)=>Math.max(e,t))},d=(e,t)=>"true"===e.getAttribute(t),l=e=>document.querySelector(`#${e.dataset.task}`),m=e=>document.querySelector(`.window[data-task="${e.id}"]`),c=(e,t)=>{t&&(e.classList.add("remove-outline"),e.addEventListener("blur",()=>e.classList.remove("remove-outline"),{once:!0}))},f=(e,t)=>{let i=document.querySelector("#page-hook");i.removeAttribute("data-window-open"),i.removeAttribute("data-popup-open"),t||i.setAttribute(`data-${e.dataset.item}-open`,"")}})}();
//# sourceMappingURL=minimizeWindows.e62c6659.js.map
